"use strict";(self.webpackChunknanocosomos_documentation=self.webpackChunknanocosomos_documentation||[]).push([[6584],{28453:(e,n,l)=>{l.d(n,{R:()=>o,x:()=>a});var i=l(96540);const s={},t=i.createContext(s);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:n},e.children)}},47675:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cloud/bintu_custom_webhooks","title":"Bintu custom web hooks","description":"It\'s possible to use a custom web hook for custom based authentication.","source":"@site/docs/cloud/bintu_custom_webhooks.md","sourceDirName":"cloud","slug":"/cloud/bintu_custom_webhooks","permalink":"/docs/cloud/bintu_custom_webhooks","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1751618628000,"frontMatter":{"id":"bintu_custom_webhooks","title":"Bintu custom web hooks","sidebar_label":"Bintu custom web hooks"},"sidebar":"nanoStream Cloud","previous":{"title":"Bintu API","permalink":"/docs/cloud/bintu_api"},"next":{"title":"Bintu Stream Tags","permalink":"/docs/cloud/bintu_stream_tags"}}');var s=l(74848),t=l(28453);const o={id:"bintu_custom_webhooks",title:"Bintu custom web hooks",sidebar_label:"Bintu custom web hooks"},a=void 0,r={},d=[{value:"API",id:"api",level:2},{value:"Custom data",id:"custom-data",level:2},{value:"Example for publish",id:"example-for-publish",level:2},{value:"Example for play",id:"example-for-play",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Available Parameters per Webhook",id:"available-parameters-per-webhook",level:2}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"It's possible to use a custom web hook for custom based authentication."}),"\n",(0,s.jsx)(n.admonition,{title:"Note",type:"info",children:(0,s.jsx)(n.p,{children:"Using web hooks is the recommended way to protect your ingest workflow. Ask us for account upgrades to help with implementations or hosting"})}),"\n",(0,s.jsx)(n.admonition,{title:"Recommendation",type:"caution",children:(0,s.jsx)(n.p,{children:"Using web hooks for playback is not recommended and not always enabled. Use nanoPlayer Token Security instead."})}),"\n",(0,s.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,s.jsx)(n.p,{children:"Set the custom web hook via this api call (linux notation):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"curl -X PUT \\\nhttps://bintu.nanocosmos.de/organisation/webhook \\\n-H 'content-type: application/json' \\\n-H 'x-bintu-apikey: YOUR_BINTU_API_KEY' \\\n-d '{\n    \"webhook\": \"https://your-custom-server.com/hook\"\n}'\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Notes",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The custom api call will be called from bintu for each on_play, on_publish, on_play_done, on_publish_done and on_publish_update webhook."}),"\n",(0,s.jsx)(n.li,{children:"It's a blocking api call. You need to ensure quick response times. Long response times from the customer api server will create a delay for the time required to start a playout or publish."}),"\n",(0,s.jsx)(n.li,{children:"The customer api hook needs to reply with http status code 200, otherwise the bintu api will reject this stream and it's not possible to publish or play the stream."}),"\n",(0,s.jsx)(n.li,{children:"The custom api server should response with 200 to accept a stream and with 403 to reject a stream."}),"\n"]})}),"\n",(0,s.jsxs)(n.p,{children:["Bintu will send a POST request with header ",(0,s.jsx)(n.code,{children:"Content-Type: application/x-www-form-urlencoded"})," and body will contain url encoded form data as in the following example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"call=publish&name=CD6xx-123456&type=live&app=live&addr=xxx.yyy.zzz.aaa&clientid=123456\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"For the publish_done webhook, the request body also contains the keys bytes_in and bytes_out. The unit of the values is byte."})}),"\n",(0,s.jsx)(n.h2,{id:"custom-data",children:"Custom data"}),"\n",(0,s.jsx)(n.p,{children:"Its possible to amend this body with custom fields/data by adding the data as query parameter to the stream-name."}),"\n",(0,s.jsx)(n.h2,{id:"example-for-publish",children:"Example for publish"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"rtmp://bintu-stream.nanocosmos.de:80/live/CD6xx-123456?foo=bar&batz=12345"})}),"\n",(0,s.jsx)(n.p,{children:"This stream name will result in the request body below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"foo=bar&batz=12345&call=publish&name=CD6xx-123456&type=live&app=live&tcurl=rtmp%3A%2F%2Fbintu-stream.nanocosmos.de%3A1935%2Flive\n&addr=xxx.yyy.zzz.aaa&clientid=123456    \n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-for-play",children:"Example for play"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"http://demo.nanocosmos.de/nanoplayer/release/nanoplayer.html?h5live.server=bintu-play.nanocosmos.de&h5live.rtmp.url=rtmp://bintu-play.nanocosmos.de/play&h5live.rtmp.streamname=CD6xx-123456?test%3D123"})}),"\n",(0,s.jsx)(n.p,{children:"Which will result in the request body below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"test=123&call=play&name=CD6xx-123456&start=0&duration=0&reset=0&app=play&addr=xxx.yyy.zzz.aaa&clientid=123456    \n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(n.p,{children:["You might need to url encode your parameters, e.g. ",(0,s.jsx)(n.code,{children:"test=123"})," needs to be url encoded: ",(0,s.jsx)(n.code,{children:"test%3D123"})]})}),"\n",(0,s.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"call"}),": 'play_done',  Webhook play, publish, play_done, publish_done, update_publish"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"name"}),": 'YYstV-BVPq4', stream name"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"bytes_in"}),": '575', Bytes, received by rtmp server"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"bytes_out"}),": '8516372', Bytes sent by rtmp server"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"addr"}),": '17.31.43.214', Client IP Addr"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"clientid"}),": '9466245' internal client id (displayed in log and stat)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"time"}),": '46807', number of seconds since play/publish call"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"timestamp"}),": '46805903', timestamp of the last audio/video packet sent to the client"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"available-parameters-per-webhook",children:"Available Parameters per Webhook"}),"\n",(0,s.jsx)(n.p,{children:"Webhook play:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"call"}),"\n",(0,s.jsx)(n.li,{children:"name"}),"\n",(0,s.jsx)(n.li,{children:"start"}),"\n",(0,s.jsx)(n.li,{children:"duration"}),"\n",(0,s.jsx)(n.li,{children:"app"}),"\n",(0,s.jsx)(n.li,{children:"addr"}),"\n",(0,s.jsx)(n.li,{children:"clientid"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Webhook play_done:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"call"}),"\n",(0,s.jsx)(n.li,{children:"name"}),"\n",(0,s.jsx)(n.li,{children:"bytes_in"}),"\n",(0,s.jsx)(n.li,{children:"bytes_out"}),"\n",(0,s.jsx)(n.li,{children:"app"}),"\n",(0,s.jsx)(n.li,{children:"addr"}),"\n",(0,s.jsx)(n.li,{children:"clientid"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Webhook publish:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"call"}),"\n",(0,s.jsx)(n.li,{children:"name"}),"\n",(0,s.jsx)(n.li,{children:"app"}),"\n",(0,s.jsx)(n.li,{children:"addr"}),"\n",(0,s.jsx)(n.li,{children:"clientid"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Webhook publish_done:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"call"}),"\n",(0,s.jsx)(n.li,{children:"name"}),"\n",(0,s.jsx)(n.li,{children:"bytes_in"}),"\n",(0,s.jsx)(n.li,{children:"bytes_out"}),"\n",(0,s.jsx)(n.li,{children:"app"}),"\n",(0,s.jsx)(n.li,{children:"addr"}),"\n",(0,s.jsx)(n.li,{children:"clientid"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Webhook update_publish:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"call"}),"\n",(0,s.jsx)(n.li,{children:"time"}),"\n",(0,s.jsx)(n.li,{children:"timestamp"}),"\n",(0,s.jsx)(n.li,{children:"name"}),"\n",(0,s.jsx)(n.li,{children:"app"}),"\n",(0,s.jsx)(n.li,{children:"addr"}),"\n",(0,s.jsx)(n.li,{children:"clientid"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);